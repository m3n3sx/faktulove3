{% extends "admin/change_form.html" %}
{% load admin_urls %}
{% load design_system %}

{% block form_top %}
    {{ block.super }}
    
    {% if opts.model_name == 'faktura' %}
        <div class="django-design-system django-polish-business">
            <div class="admin-form-header">
                <h2>{% if original %}Edycja faktury{% else %}Nowa faktura{% endif %}</h2>
                {% if original %}
                    <div class="invoice-status-display">
                        {% ds_invoice_status_badge original.status %}
                    </div>
                {% endif %}
            </div>
        </div>
    {% endif %}
{% endblock %}

{% block field_sets %}
    <div class="django-design-system django-polish-business">
        {{ block.super }}
    </div>
{% endblock %}

{% block submit_buttons_bottom %}
    <div class="django-design-system">
        <div class="submit-row-enhanced">
            {% if has_add_permission %}
                <input type="submit" value="{% if original %}Zapisz zmiany{% else %}Dodaj{% endif %}" class="default" name="_save">
            {% endif %}
            
            {% if has_change_permission and has_view_permission %}
                <input type="submit" value="Zapisz i kontynuuj edycję" class="default" name="_continue">
            {% endif %}
            
            {% if has_add_permission %}
                <input type="submit" value="Zapisz i dodaj kolejny" class="default" name="_addanother">
            {% endif %}
            
            {% if change and has_delete_permission %}
                <p class="deletelink-box">
                    <a href="{% url opts|admin_urlname:'delete' original.pk|admin_urlquote %}" class="deletelink">
                        Usuń
                    </a>
                </p>
            {% endif %}
        </div>
    </div>
    
    <style>
        .admin-form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-4);
            padding: var(--spacing-4);
            background: var(--color-background-secondary);
            border-radius: var(--border-radius-md);
            border: 1px solid var(--color-border-default);
        }
        
        .admin-form-header h2 {
            margin: 0;
            color: var(--color-text-primary);
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-semibold);
        }
        
        .invoice-status-display {
            display: flex;
            align-items: center;
            gap: var(--spacing-2);
        }
        
        .submit-row-enhanced {
            display: flex;
            gap: var(--spacing-2);
            align-items: center;
            flex-wrap: wrap;
            padding: var(--spacing-4);
            background: var(--color-background-secondary);
            border-radius: var(--border-radius-md);
            border: 1px solid var(--color-border-default);
            margin-top: var(--spacing-4);
        }
        
        .submit-row-enhanced input[type="submit"] {
            margin: 0 !important;
        }
        
        .deletelink-box {
            margin-left: auto;
            margin-bottom: 0;
        }
        
        .deletelink {
            background: var(--color-status-error) !important;
            color: var(--color-text-inverse) !important;
            border: 1px solid var(--color-status-error) !important;
            border-radius: var(--border-radius-md) !important;
            padding: var(--spacing-2) var(--spacing-4) !important;
            text-decoration: none !important;
            font-size: var(--font-size-base) !important;
            font-weight: var(--font-weight-medium) !important;
            transition: all var(--animation-duration-fast) var(--animation-easing-ease-out) !important;
        }
        
        .deletelink:hover {
            background: var(--color-error-700) !important;
            border-color: var(--color-error-700) !important;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .admin-form-header {
                flex-direction: column;
                gap: var(--spacing-2);
                align-items: stretch;
            }
            
            .submit-row-enhanced {
                flex-direction: column;
                align-items: stretch;
            }
            
            .deletelink-box {
                margin-left: 0;
                margin-top: var(--spacing-2);
            }
        }
    </style>
{% endblock %}
<!-- meta tags and other links -->
<!DOCTYPE html>
<html lang="pl" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="csrf-token" content="{{ csrf_token }}">
  <title>FaktuLove.pl</title>
  {% load static %}
  {% load i18n %}

  <!-- Expose Django static URL to JavaScript -->
  <script>
    window.STATIC_URL = '{% get_static_prefix %}';
  </script>

  <!-- Core CSS -->
  <link rel="icon" type="image/png" href="{% static 'assets/images/logo-icon.png' %}" sizes="16x16">
  <link rel="stylesheet" href="{% static 'assets/css/remixicon.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/bootstrap.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/dataTables.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/editor-katex.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/editor.atom-one-dark.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/editor.quill.snow.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/flatpickr.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/full-calendar.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/jquery-jvectormap-2.0.5.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/magnific-popup.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/slick.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/prism.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/file-upload.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/audioplayer.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/lib/toastify.min.css' %}">
  
  <!-- Main CSS -->
  <link rel="stylesheet" href="{% static 'assets/css/style.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/ui-fixes.css' %}">
  
  {% block extra_head %}{% endblock %}
</head>
<body class="django-design-system django-polish-business">

  <!-- Notification container -->
  <div id="new-notifications" class="notification-list"></div>
  
  <!-- Sidebar -->
  {% include "partials/base/navi-sidebar.html" with firma=firma %}

  <!-- Main content -->
  <main class="dashboard-main">
    <!-- Header -->
    {% include "partials/base/navi-header.html" %}

    <!-- Main body -->
    <div class="dashboard-main-body">
      {% block content %}
      {% endblock %}
    </div>
  </main>

  <!-- Footer -->
  {% include "partials/base/footer.html" %}

  <!-- Core JavaScript Libraries -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="{% static 'assets/js/lib/bootstrap.bundle.min.js' %}"></script>
  <script src="https://code.iconify.design/3/3.1.1/iconify.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.44.0/dist/apexcharts.min.js" onload="console.log('ApexCharts loaded')"></script>
  <script src="{% static 'assets/js/lib/toastify.min.js' %}"></script>

  <!-- Application JavaScript -->
  <script src="{% static 'assets/js/csrf-utils.js' %}"></script>
  <script src="{% static 'assets/js/dropdown-fix.js' %}"></script>
  <script src="{% static 'assets/js/app.js' %}"></script>

  <!-- Chart initialization -->
  <script>
    // Safe chart initialization
    function safeInitCharts() {
      if (typeof ApexCharts === 'undefined') {
        console.warn('ApexCharts not loaded, skipping chart initialization');
        return;
      }
      
      // Only initialize charts if elements exist
      const chartElements = document.querySelectorAll('[id*="chart"], .chart-container');
      if (chartElements.length === 0) {
        console.log('No chart elements found, skipping chart initialization');
        return;
      }
      
      console.log('Initializing charts for', chartElements.length, 'elements');
    }
    
    // Override chart functions to prevent errors
    window.createWidgetChartMonth = window.createWidgetChartMonth || function() { console.log('Chart function called but not implemented'); };
    window.createWidgetChartQuarter = window.createWidgetChartQuarter || function() { console.log('Chart function called but not implemented'); };
    window.createWidgetChartYear = window.createWidgetChartYear || function() { console.log('Chart function called but not implemented'); };
    window.createWidgetChartWeek = window.createWidgetChartWeek || function() { console.log('Chart function called but not implemented'); };
    window.createWidgetChartWeekCost = window.createWidgetChartWeekCost || function() { console.log('Chart function called but not implemented'); };
    window.createWidgetChartMonthCost = window.createWidgetChartMonthCost || function() { console.log('Chart function called but not implemented'); };
    window.createWidgetChartQuarterCost = window.createWidgetChartQuarterCost || function() { console.log('Chart function called but not implemented'); };
    window.createWidgetChartYearCost = window.createWidgetChartYearCost || function() { console.log('Chart function called but not implemented'); };
    
    $(document).ready(function() {
      console.log('ðŸš€ FaktuLove Ready');
      setTimeout(safeInitCharts, 1000);
    });
  </script>

  {% block extra_js %}{% endblock %}
</body>
</html>
{% load design_system %}

<div class="form-group django-form django-polish-business{% if errors %} has-error{% endif %}">
    {% if label %}
        <label for="{{ field.id_for_label }}" class="form-label{% if required %} required{% endif %}">
            {{ label }}
            {% if required %}<span class="text-error" aria-label="wymagane">*</span>{% endif %}
        </label>
    {% endif %}
    
    <div class="form-input-wrapper vat-rate-wrapper">
        <select name="{{ field.name }}" id="{{ field.id_for_label }}" 
                class="form-control vat-rate-select"
                {% if required %}required{% endif %}
                aria-describedby="{{ field.id_for_label }}_help">
            
            {% if not required %}
                <option value="">---------</option>
            {% endif %}
            
            <option value="0" {% if field.value == "0" or field.value == 0 %}selected{% endif %}>0%</option>
            <option value="0.05" {% if field.value == "0.05" or field.value == 0.05 %}selected{% endif %}>5%</option>
            <option value="0.08" {% if field.value == "0.08" or field.value == 0.08 %}selected{% endif %}>8%</option>
            <option value="0.23" {% if field.value == "0.23" or field.value == 0.23 %}selected{% endif %}>23%</option>
            <option value="-1" {% if field.value == "-1" or field.value == -1 %}selected{% endif %}>zw. (zwolniony)</option>
        </select>
        
        <div class="vat-info" id="{{ field.id_for_label }}_help">
            <small class="text-muted">Wybierz odpowiednią stawkę VAT zgodną z polskim prawem</small>
        </div>
        
        {% if errors %}
            <ul class="errorlist" role="alert" aria-live="polite">
                {% for error in errors %}
                    <li>{{ error }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    </div>
</div>

<style>
.vat-rate-wrapper .vat-rate-select {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
    background-position: right var(--spacing-2) center;
    background-repeat: no-repeat;
    background-size: 1.5em 1.5em;
    padding-right: var(--spacing-8);
}

.vat-rate-wrapper .vat-info {
    margin-top: var(--spacing-1);
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
}
</style>